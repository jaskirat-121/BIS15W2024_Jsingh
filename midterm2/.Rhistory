library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
glimpse(sharks)
miss_var_summary(sharks)
View(sharks)
sharks <- sharks %>%
filter(incident_num != "NOT COUNTED")
View(sharks)
sharks %>%
count(county)
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
labs(title= "Number of shark incidents across various counties",
x= "county", y="Number of incidents")
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
labs(title= "Number of shark incidents across various counties",
x= "county", y="Number of incidents")+
coord_flip()
sharks %>%
count(county, sort=T)
sharks %>%
group_by(month)
sharks %>%
count(month)
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n, fill=month))+
geom_col()+
labs(title= "Number of incidents in each month",
x= "Month", y="Number of incidents")
sharks %>%
count(month) %>%
mutate(month = as.factor(month))
ggplot(aes(x=month, y=n, fill=month))+
geom_col()+
labs(title= "Number of incidents in each month",
x= "Month", y="Number of incidents")
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x=month, y=n, fill=month))+
geom_col()+
labs(title= "Number of incidents in each month",
x= "Month", y="Number of incidents")
sharks %>%
count(month, sort=T)
sharks %>%
county(county, injury)
sharks %>%
count(county, injury)
sharks %>%
count(county, injury) %>%
arrange(desc(injury))
sharks %>%
count(county, injury) %>%
filter(injury=="fatal")
sharks %>%
count(county, injury) %>%
filter(injury=="fatal") %>%
ararnge(desc(n))
sharks %>%
count(county, injury) %>%
filter(injury=="fatal") %>%
arrange(desc(n))
sharks %>%
count(county, injury)
sharks %>%
count(mode)
sharks %>%
count(mode, injury)
sharks %>%
filter(injury != "none") %>%
count(mode, injury)
sharks %>%
count(mode, incident_num)
sharks %>%
group_by(mode) %>%
count(incident_num)
sharks %>%
count(mode)
sharks %>%
ggplot(aes(x=injury))+
geom_bar()
sharks %>%
ggplot(aes(x=injury))+
geom_bar()+
facet_wrap(~mode)
sharks %>%
ggplot(aes(x=injury))+
geom_bar()+
facet_wrap(~mode)+
labs(title= "Number of different injuries reported based on activity",
x= "Type of injury", y="Number of injuries")
sharks %>%
ggplot(aes(x=injury, fill=injury))+
geom_bar()+
facet_wrap(~mode)+
labs(title= "Number of different injuries reported based on activity",
x= "Type of injury", y="Number of injuries")
sharks %>%
count(species, sort=T)
sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury))+
geom_bar()
sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury, fill=injury))+
geom_bar()
sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury, fill=injury))+
geom_bar()+
labs(title= "Type of Ijury reported for encounter with White sharks",
x="Type of injury", y="Number of cases reported")
white_sharks <- read_csv("data/White sharks tracked from Southeast Farallon Island, CA, USA, 1999 2004.csv", na = c("?", "n/a")) %>% clean_names()
glimpse(white_sharks)
miss_var_summary(white_sharks)
View(white_sharks)
View(white_sharks)
white_sharks %>%
group_by(sex) %>%
summarize(averge_length=mean(total_length_cm))
white_sharks %>%
filter(sex != "NA") %>%
group_by(sex) %>%
summarize(averge_length=mean(total_length_cm))
white_sharks %>%
ggplot(aes(x=sex, y=total_length_cm))+
geom_boxplot()
white_sharks %>%
filter(sex != "NA")
ggplot(aes(x=sex, y=total_length_cm))+
geom_boxplot()
white_sharks %>%
filter(sex != "NA") %>%
ggplot(aes(x=sex, y=total_length_cm))+
geom_boxplot()
white_sharks %>%
filter(sex != "NA") %>%
ggplot(aes(x=sex, y=total_length_cm, fill=sex))+
geom_boxplot()
white_sharks %>%
filter(sex != "NA") %>%
ggplot(aes(x=sex, y=total_length_cm, fill=sex))+
geom_boxplot()+
labs(title = "Total Length ranges for male and female white sharks")
View(sharks)
sharks %>%
ggplot(x=injury, fill = species)+
geom_bar()
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar()
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")
sharks %>%
count(month) %>%
mutate(month = as.factor(month))
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
rename(Jan = 1)
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
mutate(Jan = 1)
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
mutate(Jan == 1)
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
mutate(Jan = "1")
sharks %>%
count(month) %>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x=month, y=n, fill=month))+
geom_col()+
labs(title= "Number of incidents in each month",
x= "Month", y="Number of incidents")
sharks %>%
count(mode, sort=T)
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar()+
facet_wrap(~injury)
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")+
facet_wrap(~injury)
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")+
facet_wrap(~species)
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")
sharks %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")+
facet_wrap(~county)
sharks %>%
count(county) %>%
sharks %>%
count(county) %>%
sharks %>%
count(county)
sharks %>%
count(county)
sharks %>%
count(county) %>%
top_n(3)
sharks %>%
count(county) %>%
top_n(4)
sharks %>%
count(county) %>%
top_n(2)
sharks %>%
filter(county == "Santa Barbara"|county== "San Diego") %>%
ggplot(aes(x=injury, fill = species))+
geom_bar(position = "dodge")+
facet_wrap(~county)
sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury, fill=injury))+
geom_bar()+
labs(title= "Type of injury reported for encounter with White sharks",
x="Type of injury", y="Number of cases reported")
white_sharks %>%
filter(sex != "NA") %>%
ggplot(aes(x=sex, y=total_length_cm, fill=sex))+
geom_boxplot()+
labs(title = "Total length ranges for male and female white sharks")
